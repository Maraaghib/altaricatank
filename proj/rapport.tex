\documentclass[a4paper]{book}
\usepackage{fullpage}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[francais]{babel}

\usepackage{latexsym}
\usepackage{fancyhdr}
\usepackage{makeidx}
\usepackage{graphics}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{moreverb}
\usepackage{listings}

\newcommand{\altarica}{{\sc AltaRica}}

\begin{document}

\title{Master 1, Conceptions Formelles\\
Projet du module \altarica\\
Synthèse (assistée) d'un contrôleur du niveau d'une cuve}

\date{}

\author{Nom1 \and Nom2 \and Nom3}

\maketitle

\chapter{Le sujet}
\input{tank}

\chapter{Le rapport}
\section{Rôle de la constante {\tt nbFailures} (2 points)}
La constante nbFailures est utilisée pour limiter le nombre de configurations atteignables. Elle correspond au nombre de valves qui peuvent être en panne en même temps.

$nbFailures >= (V[0].fail + V[1].fail + V[2].fail)$ correspond au fait que le nombre de valve qui tombent en panne doit toujours être inférieur à la valeur de la constante nbFailure, car cette ligne se trouve dans la section $assert$ du code.

\section{Résultats avec le contrôleur initial {\tt Ctrl}}
\subsection{Calcul d'un contrôleur}
\subsubsection{Avec 0 défaillance (1 point)}
\lstinputlisting{Res/System0FCtrl.res}
\lstinputlisting{Res/System0FCtrl0F1I.res}
%\lstinputlisting{Res/System0FCtrl0F2I.res}
%\lstinputlisting{Res/System0FCtrl0F3I.res}
%\lstinputlisting{Res/System0FCtrl0F4I.res}
\paragraph{Interprétation des résultats : Contrôleur sans débit optimisé}
Le controlleur peut controller en évitant les blocages car $deadlock = 0$. Cependant, il ne peut pas assurer qu'on évitera les situations redoutés,
car on peut voir que $SR = 86$, ce qui indique qu'il y a 86 états dans lesquels le controlleurs se trouvera dans une situation redoutée.

\paragraph{Interprétation des résultats : Contrôleur avec débit optimisé}

Lorsqu'on optimise le débit aval, il est possible de contrôller en évitant tout blocages ou toute situation critique. En effet, la variable $SR = 0$.
On peut voir que dans ce contrôleur on a un total de 96 états ($any\_s$) et 858 transitions ($any\_t$). On peut aussi voir, via $CtrlCanControl$, qu'il y a 27 transisitions possibles différentes à partir de l'état initial du contrôleur.

\subsubsection{Avec 1 défaillance (1 point)}
\lstinputlisting{Res/System1FCtrl.res}
\lstinputlisting{Res/System1FCtrl1F1I.res}
%\lstinputlisting{Res/System1FCtrl1F2I.res}
%\lstinputlisting{Res/System1FCtrl1F3I.res}
%\lstinputlisting{Res/System1FCtrl1F4I.res}
\paragraph{Interprétation des résultats : contrôleur non optimisé}
Avec 1 défaillance, on remarque qu'on peut pas contrôler en évitant les situations rédoutées car $SR$ est égale à l'union de $deadlock$ et de $NC$.
Donc dans notre cas, on a $SR$ qui partage les mêmes états avec $NC$.

Conclusion : le controleur peut contrôler car la variable CtrlCanControl est positive, mais on ne peut pas éviter de tomber dans des situations redoutées.

\paragraph{Interprétation des résultats : contrôleur non optimisé}
Avec l'optimisation du débit 'aval', on remarque qu'on a moins d'états à gérer donc c'est plus facile pour le contrôleur de controler.

Cependant, on s'apperçoit dorénavant qu'on peut avoir des blocages à cause de la variable $deadlock = 96$, ce qui revient à dire qu'on ne peut pas contrôler sans éviter de tomber dans des situations redoutées car :

$NC$ et $deadlock$ partagent $69$ états et donc on risque d'augmenter les chances de tomber dans des états bloquants.

Conclusion : Malgré le fait qu'on ait optimisé le débit d'aval, on a constaté qu'on ne pourrait pas contrôler sans éviter de tomber dans $SR$ ou dans $deadlock$.
Aussi, on peut bien voir que $CCoupGagnant$ a beaucoup moins de transitions($2909$).

\subsubsection{Avec 2 défaillances (1 point)}
\lstinputlisting{Res/System2FCtrl.res}
\lstinputlisting{Res/System2FCtrl2F1I.res}
%\lstinputlisting{Res/System2FCtrl2F2I.res}
%\lstinputlisting{Res/System2FCtrl2F3I.res}
%\lstinputlisting{Res/System2FCtrl2F4I.res}
\paragraph{Interprétation des résultats : Contrôleur sans débit optimisé}
Ce controlleur peut aussi s'éxécuter en évitant les blocages car $deadlock = 0$. Cependant, il ne peut pas assurer qu'on évitera les situations redoutés.
Ici, $SR = 551$. On a donc beaucoup d'états dans lesquels on ne souhaite pas aller. Ceci est dû au fait qu'on peut avoir deux valves défaillantes.
Si une d'entre elle est celle de la sortie, on ne peut alors plus vider l'eau de la cuve et on atteint facilement les situations redoutées.

\paragraph{Interprétation des résultats : Contrôleur avec débit optimisé}

Lorsqu'on optimise le débit aval, on diminue le nombre de situations redoutées. Elle passent de 551 à 239. Cependant, on peut bloquer le système
car $deadlock = 239$. On peut noter que tous les niveaux critiques sont des situations où l'on se bloque, sinon on aurait $SR > deadlock$ (par l'absurde, si il existe un état dans $NC$ différent de tous ceux de $deadlock$ alors, $|NC \cup deadlock| > |deadlock|$)


\subsubsection{Avec 3 défaillances (1 point)}
\lstinputlisting{Res/System3FCtrl.res}
\lstinputlisting{Res/System3FCtrl3F1I.res}
%\lstinputlisting{Res/System3FCtrl3F2I.res}
%\lstinputlisting{Res/System3FCtrl3F3I.res}
%\lstinputlisting{Res/System3FCtrl3F4I.res}
\paragraph{Interprétation des résultats}
% A COMPLETER

\subsection{Calcul des contrôleurs optimisés (2 points)}
% A COMPLETER en expliquant en quoi consiste l'optimisation mise en place.

% A COMPLETER en analysant les contrôleurs optimisés obtenus.

\section{Rôle des composants {\tt ValveVirtual} et {\tt CtrlVV} (4 points)}
% A COMPLETER en expliquant le mécanisme mis en oeuvre et son rôle.

\section{Résultats avec le contrôleur initial {\tt CtrlVV}}
\subsection{Calcul d'un contrôleur}
\subsubsection{Avec 0 défaillance (1 point)}
\lstinputlisting{Res/System0FCtrlVV.res}
\lstinputlisting{Res/System0FCtrlVV0F1I.res}
%\lstinputlisting{Res/System0FCtrlVV0F2I.res}
%\lstinputlisting{Res/System0FCtrlVV0F3I.res}
%\lstinputlisting{Res/System0FCtrlVV0F4I.res}
\paragraph{Interprétation des résultats}
% A COMPLETER

\subsubsection{Avec 1 défaillance (1 point)}
\lstinputlisting{Res/System1FCtrlVV.res}
\lstinputlisting{Res/System1FCtrlVV1F1I.res}
%\lstinputlisting{Res/System1FCtrlVV1F2I.res}
%\lstinputlisting{Res/System1FCtrlVV1F3I.res}
%\lstinputlisting{Res/System1FCtrlVV1F4I.res}
\paragraph{Interprétation des résultats}
% A COMPLETER

\subsubsection{Avec 2 défaillances (1 point)}
\lstinputlisting{Res/System2FCtrlVV.res}
\lstinputlisting{Res/System2FCtrlVV2F1I.res}
%\lstinputlisting{Res/System2FCtrlVV2F2I.res}
%\lstinputlisting{Res/System2FCtrlVV2F3I.res}
%\lstinputlisting{Res/System2FCtrlVV2F4I.res}
\paragraph{Interprétation des résultats}
% A COMPLETER

\subsubsection{Avec 3 défaillances (1 point)}
\lstinputlisting{Res/System3FCtrlVV.res}
\lstinputlisting{Res/System3FCtrlVV3F1I.res}
%\lstinputlisting{Res/System3FCtrlVV3F2I.res}
%\lstinputlisting{Res/System3FCtrlVV3F3I.res}
%\lstinputlisting{Res/System3FCtrlVV3F4I.res}
\paragraph{Interprétation des résultats}
% A COMPLETER

\subsection{Calcul des contrôleurs optimisés (2 points)}
% A COMPLETER en analysant les contrôleurs optimisés obtenus.

\section{Conclusion (2 points)}
% A COMPLETER

\end{document}
